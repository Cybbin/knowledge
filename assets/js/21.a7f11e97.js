(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{382:function(v,_,e){"use strict";e.r(_);var o=e(43),s=Object(o.a)({},(function(){var v=this,_=v.$createElement,e=v._self._c||_;return e("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[e("h1",{attrs:{id:"session-cookie"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#session-cookie"}},[v._v("#")]),v._v(" session-cookie")]),v._v(" "),e("p",[v._v("利用服务端的 "),e("code",[v._v("Session")]),v._v(" 和客户端的 "),e("code",[v._v("Cookie")]),v._v(" 来实现前后端的鉴权，"),e("code",[v._v("Session")]),v._v(" 是依据 "),e("code",[v._v("Cookie")]),v._v(" 来识别是否是同一个用户。")]),v._v(" "),e("h2",{attrs:{id:"过程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#过程"}},[v._v("#")]),v._v(" 过程")]),v._v(" "),e("ol",[e("li",[v._v("客户端使用用户名跟密码请求登录;")]),v._v(" "),e("li",[v._v("服务端验证通过后，在当前会话 "),e("code",[v._v("session")]),v._v(" 保存相关数据，如用户角色，登录时间等；")]),v._v(" "),e("li",[v._v("服务端向客户端通过 "),e("code",[v._v("response header")]),v._v(" 的 "),e("code",[v._v("Set-Cookie")]),v._v(" 返回一个 "),e("code",[v._v("SESSONID")]),v._v("，写入用户的 "),e("code",[v._v("cookie")]),v._v("；")]),v._v(" "),e("li",[v._v("客户端之后的每一次请求，通过 "),e("code",[v._v("resquest header")]),v._v(" 的 "),e("code",[v._v("Cookie")]),v._v(" 带上这个"),e("code",[v._v("SESSONID")]),v._v("；")]),v._v(" "),e("li",[v._v("服务端通过这个 "),e("code",[v._v("SESSONID")]),v._v("，找到之前保存的相关数据，从而知道用户的身份。")])]),v._v(" "),e("img",{attrs:{src:v.$withBase("/assets/program/authentication/session-cookie")}}),v._v(" "),e("h2",{attrs:{id:"缺点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缺点"}},[v._v("#")]),v._v(" 缺点")]),v._v(" "),e("ol",[e("li",[v._v("易受到 "),e("code",[v._v("CSRF")]),v._v(" 攻击，基于 "),e("code",[v._v("Cookie")]),v._v(" 的一种跨站伪造攻击；")]),v._v(" "),e("li",[v._v("服务器内存消耗大，用户每一次认证，就需要在内存做一次记录；")]),v._v(" "),e("li",[v._v("服务器集群、跨域的服务导向结构，要求 "),e("code",[v._v("Session")]),v._v(" 数据共享，每台服务器都需要能读取 "),e("code",[v._v("Session")]),v._v("。")])]),v._v(" "),e("p",[e("strong",[e("code",[v._v("Session")]),v._v(" 共享：")])]),v._v(" "),e("ol",[e("li",[v._v("根据请求的 "),e("code",[v._v("IP")]),v._v(" 进行 "),e("code",[v._v("Hash")]),v._v(" 映射到对应的机器上（这就相当于请求的"),e("code",[v._v("IP")]),v._v("一直会访问同一个服务器）。【如果服务器宕机了，会丢失了一大部分Session的数据，不建议】")]),v._v(" "),e("li",[e("code",[v._v("Session")]),v._v(" 复制：任何一个服务器 "),e("code",[v._v("Session")]),v._v(" 发生变化，就广播给其他节点，同步更新。【会影响集群的性能呢，不建议】")]),v._v(" "),e("li",[v._v("把 "),e("code",[v._v("Session")]),v._v(" 数据放在 "),e("code",[v._v("Redis")]),v._v(" 中(注：如果 "),e("code",[v._v("Reis")]),v._v(" 挂了，就无法校验)。")])]),v._v(" "),e("p",[e("strong",[e("code",[v._v("Cookie")]),v._v(" 跨域：")])]),v._v(" "),e("ol",[e("li",[v._v("利用 "),e("code",[v._v("Token")]),v._v(" 解决；")]),v._v(" "),e("li",[v._v("多个域名共享 "),e("code",[v._v("Cookie")]),v._v("，设置 "),e("code",[v._v("Cookie")]),v._v(" 的 "),e("code",[v._v("domain")]),v._v(" 。")])]),v._v(" "),e("hr")])}),[],!1,null,null,null);_.default=s.exports}}]);