# HTTP

## 概念

HTTP是一个应用层协议，是一个请求/响应模型，由客户端发起请求，服务端返回响应。

### 特点

1. 简单快速
2. 基于请求和响应模型的协议
3. 无连接
4. 无状态
5. 灵活

---

### 报文

由头部和正文构成。

请求报文：
头部包含HTTP版本号、请求方法、请求URL、请求首部字段。
空行
正文

响应报文：
头部包含HTTP版本号、状态码、状态码描述语、响应首部字段。
正文

---

### 请求方法

GET：获取URL指定资源。  
POST：传输实体信息。  
OPTIONS：询问支持的请求方法。  
HEAD：获取报文首部，与GET相比，不返回报文主体部分。  
PUT：上传文件。  
DELETE：删除文件。  
TRACE：追踪请求的路径。  
CONNECT：要求在与代理服务器通信时建立隧道，使用隧道进行TCP通信。主要使用SSL和TLS将数据加密后通过网络隧道进行传输。

**GET、POST区别**
  1. GET能被浏览器缓存，POST不能；
  2. GET能添加到书签，POST不能；
  3. GET的请求参数放在URL里，POST放在请求主体里；
  4. GET能传输的数据量比POST小，一般限制在2KB左右；
  5. GET请求只能支持URL编码，POST支持多种编码；
  6. 相对来说，GET请求更不安全，因为参数直接暴露在URL上。

**OPTIONS 在复杂请求的场景会触发，触发条件：**
  1. 请求方法不是GET、POST、HEAD这种简单请求
  2. 请求头部包含自定义字段
  3. Conent-type不为 application/x-www-form-urlencode、multipart/form-data、text/plain（也就是设置为 application/json）

---

## HTTP 状态码

1xx：已收到请求，正在处理  
200：请求成功  
206：成功返回部分数据  
301：永久重定向  
302：临时重定向  
303：临时重定向，明确客户端应该使用GET  
304：资源没有过期，协商缓存  
307：临时重定向，POST不会变成GET  
400：客户端报错  
401：没有登录认证  
403：没有权限访问  
404：资源找不到  
500：服务器报错  
503：服务器当前无法处理请求  

---

## HTTP 版本

### HTTP 1.0
特性：
1. 无状态：服务器不跟踪不记录请求过的状态。
2. 无连接：浏览器每次请求都需要建立 TCP 连接。
* 无法复用连接：每次都需要三次握手四次挥手，网络利用率低、浪费开销；
* 队头阻塞：HTTP 1.0 规定，前一个请求响应到达后下一个请求才能发送，如果前一个阻塞，后面的请求也会阻塞。

### HTTP 1.1
特性：
1. 基于长连接：新增 Connection 字段，设置为 keep-alive 保持连接不断开。
  * HTTP 1.1 默认保持长连接，数据传输完后继续保持 TCP 连接不断开。
2. 管道化：基于长连接的基础，管道化可以不用等前面的响应到达后再发送后面的请求，但响应的顺序还是按照请求的顺序返回。
3. 缓存处理：新增缓存处理字段 cache-control、Etag。
4. 断点传输：新增字段 Range，资源过大时，切分为多个部分，分别上传/下载。

### HTTP 2
特性：
1. 二进制分帧：
  * HTTP 1.x 解析是基于文本， HTTP 2 将信息分割成更小的信息和帧，并采用二进制格式的编码，方便计算机解析，提高传输效率。
2. 多路复用：
  * 同一域名下的所有访问都是从一个 TCP 连接中走；
  * HTTP 消息被分解为独立的帧、乱序发送，服务端根据标志符（Stream ID）组装成请求、响应报文。
3. 头部压缩：
  * 压缩算法 HPACK：维护静态字典和动态字典，再采用哈夫曼编码，减少高频率出现字符的索引长度。
4. 服务器推送：
  * 服务器可以主动向客户端发送消息