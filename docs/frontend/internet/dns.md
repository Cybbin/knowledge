# DNS

基于 UDP 的应用层协议。

## 解析过程
1. 浏览器缓存
2. 系统缓存
3. host 文件
4. 路由器缓存
5. 本地 DNS 服务器 递归查询，将解析结果返回给客户端

---

## 查询规则
1. 递归查询：如果主机询问的本地 DNS 服务器不知道被查询域名的 IP 地址，本地服务器会向其它根域名服务器发出查询请求，代替主机查询，而不是上主机自己进行下一步查询。
   * 主机向本地域名服务器的查询一般是递归查询。
2. 迭代查询：本地服务器向跟域名服务器发送查询请求时，要么给出 IP，要么告诉本地服务器应该向哪个域名服务器查询，然后让本地服务器进行后续的查询。

---

## 优化DNS解析速度

* DNS 预解析（DNS Prefetch）
    1. 用 meta 信息告知浏览器，当前页面要做 DNS 预解析：
    `<meta http-equiv="x-dns-prefetch-control" content="on" />`
    2. 在页面 header 使用 link 标签对 DNS 预解析：
    `<link rel="dns-prefetch" href="http://www.oneplus.com" />`
* 域名收敛：将静态资源放在一个域名下，减少 dns 解析请求